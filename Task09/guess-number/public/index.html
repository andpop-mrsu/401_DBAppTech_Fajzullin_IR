<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–£–≥–∞–¥–∞–π —á–∏—Å–ª–æ - SPA –≤–µ—Ä—Å–∏—è</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>üéØ –£–≥–∞–¥–∞–π —á–∏—Å–ª–æ</h1>
            <p class="subtitle">SPA –≤–µ—Ä—Å–∏—è —Å REST API –∏ SQLite –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö</p>
        </header>

        <main>
            <!-- –≠–∫—Ä–∞–Ω –Ω–∞—á–∞–ª–∞ –∏–≥—Ä—ã -->
            <div id="start-screen" class="screen active">
                <div class="game-info">
                    <h2>–ù–æ–≤–∞—è –∏–≥—Ä–∞</h2>
                    <p>–ö–æ–º–ø—å—é—Ç–µ—Ä –∑–∞–≥–∞–¥–∞–ª —á–∏—Å–ª–æ –æ—Ç 1 –¥–æ 100</p>
                    <p>–ü–æ–ø—Ä–æ–±—É–π —É–≥–∞–¥–∞—Ç—å –µ–≥–æ –∑–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫!</p>
                </div>
                <div class="input-section">
                    <label for="player-name">–¢–≤–æ–µ –∏–º—è:</label>
                    <input type="text" id="player-name" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è">
                    <button id="start-game" class="btn btn-primary">–ù–∞—á–∞—Ç—å –∏–≥—Ä—É</button>
                </div>
            </div>

            <!-- –≠–∫—Ä–∞–Ω –∏–≥—Ä—ã -->
            <div id="game-screen" class="screen">
                <div class="game-header">
                    <h2>–ò–≥—Ä–∞: <span id="current-player">–ò–≥—Ä–æ–∫</span></h2>
                    <div class="game-stats">
                        <span>–ü–æ–ø—ã—Ç–∫–∞: <span id="attempt-count">0</span></span>
                        <span>–ú–∞–∫—Å–∏–º—É–º: <span id="max-attempts">10</span></span>
                    </div>
                </div>

                <div class="game-input">
                    <input type="number" id="guess-input" placeholder="–í–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ –æ—Ç 1 –¥–æ 100" min="1" max="100">
                    <button id="submit-guess" class="btn btn-primary">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
                </div>

                <div class="game-feedback">
                    <div id="feedback-message" class="feedback"></div>
                </div>

                <div class="attempts-history">
                    <h3>–ò—Å—Ç–æ—Ä–∏—è –ø–æ–ø—ã—Ç–æ–∫:</h3>
                    <div id="attempts-list" class="attempts-list"></div>
                </div>

                <div class="game-actions">
                    <button id="new-game" class="btn btn-secondary">–ù–æ–≤–∞—è –∏–≥—Ä–∞</button>
                    <button id="show-stats" class="btn btn-secondary">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</button>
                </div>
            </div>

            <!-- –≠–∫—Ä–∞–Ω —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ -->
            <div id="stats-screen" class="screen">
                <h2>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–≥—Ä</h2>
                <div id="stats-content">
                    <p>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∏–≥—Ä</p>
                </div>
                <button id="back-to-game" class="btn btn-primary">–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –∏–≥—Ä–µ</button>
            </div>

            <!-- –≠–∫—Ä–∞–Ω –ø–æ–±–µ–¥—ã -->
            <div id="win-screen" class="screen">
                <div class="win-message">
                    <h2>üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!</h2>
                    <p>–í—ã —É–≥–∞–¥–∞–ª–∏ —á–∏—Å–ª–æ <span id="win-number"></span></p>
                    <p>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫: <span id="win-attempts"></span></p>
                    <button id="play-again" class="btn btn-primary">–ò–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞</button>
                </div>
            </div>

            <!-- –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö -->
            <div class="database-panel">
                <h3>üóÑÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–Ω–æ–π –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö</h3>
                <div class="db-controls">
                    <button id="show-all-games" class="btn">
                        <span>üìã</span> –°–ø–∏—Å–æ–∫ –∏–≥—Ä
                    </button>
                    <button id="clear-database" class="btn">
                        <span>üóëÔ∏è</span> –û—á–∏—Å—Ç–∏—Ç—å –ë–î
                    </button>
                    <button id="export-data" class="btn">
                        <span>üì§</span> –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
                    </button>
                    <button id="show-stats-db" class="btn">
                        <span>üìä</span> –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
                    </button>
                </div>
                <div style="text-align: center; margin-top: 10px; color: #666; font-size: 0.9em;">
                    API: http://localhost:3000/api
                </div>
            </div>

        </main>

        <footer>
            <p>–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ 9 - –ú–∏–∫—Ä–æ—Ñ—Ä–µ–π–º–≤–æ—Ä–∫ Slim</p>
        </footer>
    </div>

    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º JavaScript —Ñ–∞–π–ª—ã –≤ –ü–†–ê–í–ò–õ–¨–ù–û–ú –ø–æ—Ä—è–¥–∫–µ -->
    <script src="js/game.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/api.js"></script>  <!-- –í–ú–ï–°–¢–û database.js -->
    <script src="js/app.js"></script>
    <!-- –í –∫–æ–Ω—Ü–µ body, –ø–µ—Ä–µ–¥ app.js -->
    <script>
        // –í—Ä–µ–º–µ–Ω–Ω—ã–π GameAPI –µ—Å–ª–∏ —Ñ–∞–π–ª –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª—Å—è
        if (typeof GameAPI === 'undefined') {
            console.log('GameAPI –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω, —Å–æ–∑–¥–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã–π');
            
            class GameAPI {
                constructor() {
                    console.log('–í—Ä–µ–º–µ–Ω–Ω—ã–π GameAPI —Å–æ–∑–¥–∞–Ω');
                }
                
                async createGame(playerName, secretNumber, maxAttempts = 10) {
                    console.log('–°–æ–∑–¥–∞–Ω–∏–µ –∏–≥—Ä—ã:', playerName);
                    try {
                        const response = await fetch('/api/games', {
                            method: 'POST',
                            headers: {'Content-Type': 'application/json'},
                            body: JSON.stringify({
                                player_name: playerName,
                                secret_number: secretNumber,
                                max_attempts: maxAttempts
                            })
                        });
                        return await response.json();
                    } catch (error) {
                        console.log('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∏–≥—Ä—ã, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–π ID');
                        return {id: Math.floor(Math.random() * 1000)};
                    }
                }
                
                async getAllGames() {
                    try {
                        const response = await fetch('/api/games');
                        return await response.json();
                    } catch (error) {
                        console.log('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –∏–≥—Ä, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤');
                        return [];
                    }
                }
                
                async getGame(gameId) {
                    return null;
                }
                
                async addAttempt(gameId, attemptNumber, guess, result, message, gameFinished = false, isWin = false, totalAttempts = 0) {
                    console.log('–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ø—ã—Ç–∫–∏:', gameId);
                    return {id: 1};
                }
                
                async deleteGame(gameId) {
                    return {success: true};
                }
                
                async getStats() {
                    try {
                        const response = await fetch('/api/stats');
                        return await response.json();
                    } catch (error) {
                        console.log('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏');
                        return {
                            overall: {total_games: 0, wins: 0, avg_attempts: 0},
                            players: []
                        };
                    }
                }
                
                async exportData() {
                    const games = await this.getAllGames();
                    const data = {
                        exportDate: new Date().toISOString(),
                        totalGames: games.length,
                        games: games
                    };
                    
                    // –°–æ–∑–¥–∞–µ–º –∏ —Å–∫–∞—á–∏–≤–∞–µ–º —Ñ–∞–π–ª
                    const blob = new Blob([JSON.stringify(data, null, 2)], {type: 'application/json'});
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `games-export-${new Date().toISOString().split('T')[0]}.json`;
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                    
                    return data;
                }
            }
            
            window.GameAPI = GameAPI;
        }
    </script>
</body>
    
</html>